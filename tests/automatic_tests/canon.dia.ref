 
getf SCI/util/testexamples.sci
 
reinit_for_test()
 
%U=mopen('SCI/tests/automatic_tests/canon_data.ref','rb');
 
A = [1,2,3,4,5;
  1,0,0,0,0;
  0,1,0,0,0;
  6,7,8,9,0;
  0,0,0,1,0];
 
B = [1,2;
  0,0;
  0,0;
  2,1;
  0,0];
 
X = rand(5, 5);A = X * A * inv(X);B = X * B;//Controllable pair
 
[Ac,Bc,U,ind] = canon(A, B);//Two indices --> ind=[3.2];
 
index = 1;for k = 1:size(ind, '*') - 1,  index = [index,1 + sum(ind(1:k))];end,
 
Acstar = Ac(index, :);Bcstar = Bc(index, :);
 
s = poly(0, 's');
 
p1 = s^3 + 2 * (s^2) - 5 * s + 3;p2 = (s - 5) * (s - 3);
 
//p1 and p2 are desired closed-loop polynomials with degrees 3,2
 
c1 = coeff(p1);c1 = c1($ - 1:-1:1);c2 = coeff(p2);c2 = c2($ - 1:-1:1);
 
Acstardesired = [[-c1,0,0];[0,0,0,-c2]];
 
//Acstardesired(index,:) is companion matrix with char. pol=p1*p2
 
F = Bcstar\(Acstardesired - Acstar);//Feedbak gain
 
%ans = Ac + Bc * F;
 
if load_ref('%ans') then   bugmes();quit;end,
 
// Companion form
 
%ans = spec(A + B * F/U);
 
if load_ref('%ans') then   bugmes();quit;end,
 
// F/U is the gain matrix in original basis.
 
xdel_run(winsid());
 
 
mclose(%U);
 
