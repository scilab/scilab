// =============================================================================
// Scilab ( http://www.scilab.org/ ) - This file is part of Scilab
// Copyright (C) 2008 - INRIA - Serge Steer
//
//  This file is distributed under the same license as the Scilab package.
// =============================================================================

// <-- CLI SHELL MODE -->

// Maple code used to create reference
// Digits := 40: 
// writeto("asech.ref"): interface(prettyprint = 0): 
// for i from 1/100 by 1/100  to 1 do  print(i,evalf[30](arcsech(i), 30)) end do: 
// writeto(terminal):
// writeto("asechi.ref"): interface(prettyprint = 0): 
// for i from 1 by 1 to 100 do  print(i,evalf[30](Im(arcsech(i)), 30)) end do: 
// writeto(terminal):

ieee(2);

pi=%pi;eps=%eps;Inf=%inf;NaN=%nan; //used to make following code runnable under Matlab

ref=[1/100, 5.29829236561048459070166683494
1/50, 4.60507017098475715945057255151
3/100, 4.19948000190443579622341357041
1/25, 3.91162276521458846692162328466
1/20, 3.68825386736129666761816757203
3/50, 3.50565667988422588025418229706
7/100, 3.35117996040789760273439678213
2/25, 3.21727197115725787625531558538
9/100, 3.09906161044710277784374762698
1/10, 2.99322284612638089791266771377
11/100, 2.89738327480424948276193878475
3/25, 2.80979111975496533462007736351
13/100, 2.72911597893018568126604939796
7/50, 2.65432362465297741478973650364
3/20, 2.58459410234233415821925890050
4/25, 2.51926631553887363826303725428
17/100, 2.45779944003901340506078299866
9/50, 2.39974538361499823644852730723
19/100, 2.34472870153684957251323974325
1/5, 2.29243166956117768780078731135
21/100, 2.24258300237616220154939553225
11/50, 2.19494919863478206043226207395
23/100, 2.14932781118942637596508429965
6/25, 2.10554215036335439142012591298
1/4, 2.06343706889556054672728117262
13/50, 2.02287557376235110283740345420
27/100, 1.98373607745613930811625711237
7/25, 1.94591014905531330510535274344
29/100, 1.90930065975316177401015730659
3/10, 1.87382024252741442497699798521
31/100, 1.83939000407819337028263020722
8/25, 1.80593844091928647006641838951
33/100, 1.77340052187533955139583017875
17/50, 1.74171690712716563067877135819
7/20, 1.71083328000582707588477616285
9/25, 1.68069977242800356446350924941
37/100, 1.65127046852757629745884658139
19/50, 1.62250297391851330756311085840
39/100, 1.59435804030495178726114049785
2/5, 1.56679923697241107866405686258
41/100, 1.53979266215215038074751273692
21/50, 1.51330668842682145330645792638
43/100, 1.48731173729939019203647098001
11/25, 1.46178007882471027525728233405
9/20, 1.43668565283968581301955881777
23/50, 1.41200390885137437564526498969
47/100, 1.38771166207438258401540757590
12/25, 1.36378696346661126405387716446
49/100, 1.34020898190936490448306031490
1/2, 1.31695789692481670862504634731
51/100, 1.29401480052939600058155955654
13/25, 1.27136160699268928351886652038
53/100, 1.24898096941338899906110392882
27/50, 1.22685620214104048789228913607
11/20, 1.20497120816827395444888668991
14/25, 1.18331041069555615253048481237
57/100, 1.16185868813130886776721007432
29/50, 1.14060131183601502063247998078
59/100, 1.11952388595066476264728576887
3/5, 1.09861228866810969139524523692
61/100, 1.07785261431065644847454560608
31/50, 1.05723111556812390569654548896
63/100, 1.03673414522666822260760263463
16/25, 1.01634809667840380541358127167
13/20, .996059342442956845168396903141
33/50, .975854169851443251736244862719
67/100, .955718712936716064887849943058
17/25, .935638879435400896213162195261
69/100, .915600271629681609942735517727
7/10, .895588099529975822409629914613
71/100, .875587084610170546164345374575
18/25, .855581351937042513752362044354
73/100, .835554308060675306939677635337
37/50, .815488501420204493923772430532
3/4, .795365461223905630527890933148
19/25, .775165509721843556569115519523
77/100, .754867541415153786134169813017
39/50, .734448760913746883587252055269
79/100, .713884368684234666706672779155
4/5, .693147180559945309417232121458
81/100, .672207162226005378963325188139
41/50, .651030853357460935404294320846
83/100, .629580646774159320716981583619
21/25, .607813874464340654560093316491
17/20, .585681632340658005379787325682
43/50, .563127245371378954357318090707
87/100, .540084227905952794733162214123
22/25, .516473519435056575717742231146
89/100, .492199653442518188195136466965
9/10, .467145308103262018128381491666
91/100, .441163316286036491687456555939
23/25, .414064518876478400604077924128
93/100, .385598471143035152471210132926
47/50, .355421083214933030424847843757
19/20, .323036439271803275872468123573
24/25, .287682072451780927439219005994
97/100, .248071421618594871743278727873
49/50, .201688487798836053004338678586
99/100, .142014440746077068745796794300
1, 0.
];

refi=[1, 0.
2, 1.04719755119659774615421446109
3, 1.23095941734077468213492917825
4, 1.31811607165281796574566425465
5, 1.36943840600456582777619613942
6, 1.40334824757520728867804708560
7, 1.42744875788953126163624741148
8, 1.44546849562683122235675470528
9, 1.45945531245393272690959331963
10, 1.47062890563333682288579851219
11, 1.47976154875748153374636216687
12, 1.48736624018428161435872192933
13, 1.49379718613807303960023328050
14, 1.49930687690937608469008522307
15, 1.50408017838467135968591658837
16, 1.50825556499840522843072005474
17, 1.51193882084781538901889975615
18, 1.51521215351397914313559607464
19, 1.51814041853332682777406923942
20, 1.52077546998912660456857730482
21, 1.52315926417049348852548642166
22, 1.52532611437789946694522901009
23, 1.52730435600478080021614559858
24, 1.52911759437231875404398767202
25, 1.53078565244090769301070097229
26, 1.53232529938756829686839902146
27, 1.53375081698280461013537271444
28, 1.53507444439681782381291883271
29, 1.53630673083321779155247034604
30, 1.53745681753359453223988681087
31, 1.53853266512664965739028716182
32, 1.53954123829540146454723022175
33, 1.54048865682870974599941402767
34, 1.54138031998696394086677071465
35, 1.54222100952560396595635019425
36, 1.54301497553110139017732878010
37, 1.54376600832461819661035813949
38, 1.54447749900244974323200348902
39, 1.54515249065477899812564860867
40, 1.54579372189553548323725330249
41, 1.54640366401724145734253087025
42, 1.54698455283422787666402023143
43, 1.54753841607958607150958200276
44, 1.54806709706374697744256018110
45, 1.54857227517662946745066302078
46, 1.54905548371401313455522020534
47, 1.54951812542691618429039257783
48, 1.54996148612624823316983276016
49, 1.55038674662072261440818742236
50, 1.55079499322150612748070670543
51, 1.55118722701043716753622401649
52, 1.55156437203834322014619035380
53, 1.55192728259483738207521175947
54, 1.55227674967001675643986609484
55, 1.55261350671096012118887239296
56, 1.55293823476121504469716495860
57, 1.55325156705908088887608398801
58, 1.55355409316003305655667329298
59, 1.55384636263976934484494049048
60, 1.55412888842682511313767939899
61, 1.55440214980728195715348560612
62, 1.55466659513860522854172193405
63, 1.55492264430494093668003418356
64, 1.55517069094215966967114330825
65, 1.55541110445745229598196881054
66, 1.55564423186527446573777275846
67, 1.55587039945883337459794519058
68, 1.55608991433405141871320584746
69, 1.55630306578097727603141190641
70, 1.55651012655590347428016088015
71, 1.55671135404595505530758516590
72, 1.55690699133660636535814948842
73, 1.55709726819143668311373075965
74, 1.55728240195242854188615710156
75, 1.55746259836822660772205400999
76, 1.55763805235699393321854057494
77, 1.55780894870981268281487780822
78, 1.55797546273996630801548682101
79, 1.55813776088289956044602665240
80, 1.55829600125117297334053577795
81, 1.55845033414830200548473437972
82, 1.55860090254499142137826915405
83, 1.55874784252093703530703311800
84, 1.55889128367506477208944613518
85, 1.55903134950680682513156911952
86, 1.55916815777077280085830532380
87, 1.55930182080695687610555995282
88, 1.55943244584842731673165204015
89, 1.55956013530826971832138567236
90, 1.55968498704739784500534738121
91, 1.55980709462470403629348484063
92, 1.55992654753089313069740990132
93, 1.56004343140722822544452788203
94, 1.56015782825031203521869895077
95, 1.56026981660393296375658645158
96, 1.56037947173891922806269224847
97, 1.56048686582186656083856211187
98, 1.56059206807353435005458881518
99, 1.56069514491764083331407059845
100, 1.56079616012072950610569941457
];


 x=ref(:,1);
 e=max(abs((ref(:,2)-asech(x))./ref(:,2)));
 assert_checkfalse(e>20*eps);
 x=-ref(:,1);
 e=max(abs((ref(:,2)+imult(pi)-asech(x))./(ref(:,2)+imult(pi))));
 assert_checkfalse(e>10*eps);
 
 
 x=refi(:,1);
 e=max(abs((imult(refi(:,2))-asech(x))./refi(:,2)));
 assert_checkfalse(e>10*eps);
 x=-refi(:,1);
 e=max(abs((imult(pi-refi(:,2))-asech(x))./(pi-refi(:,2))));
 assert_checkfalse(e>10*eps);


 assert_checkequal(asech(0), Inf);
 assert_checkalmostequal(imag(asech(Inf)), pi/2);

 assert_checktrue(isnan(asech(NaN)));

 assert_checkequal(asech([]), []);

