// =============================================================================
// Scilab ( http://www.scilab.org/ ) - This file is part of Scilab
// Copyright (C) 2016 - Scilab Enterprises - Pierre-Aime AGNEL
//
//  This file is distributed under the same license as the Scilab package.
// =============================================================================
// <-- CLI SHELL MODE -->
//
// <-- Non-regression test for bug 14303 -->
//
// <-- Bugzilla URL -->
// http://bugzilla.scilab.org/14303
//
// <-- Short Description -->
// Display of matrices with scientific notation and lots of digits
// were wrong
A = [1,0,0,0,0,0,0,0;
0,1,0,0,0,0,0,0;
-1,0,2,0,0,0,0,0;
0,-3,0,4,0,0,0,0;
1,0,-8,0,8,0,0,0;
0,5,0,-20,0,16,0,0;
-1,0,18,0,-48,0,32,0;
0,-7,0,56,0,-112,0,64]
 A  = 
   1.   0.   0.    0.    0.    0.     0.    0. 
   0.   1.   0.    0.    0.    0.     0.    0. 
  -1.   0.   2.    0.    0.    0.     0.    0. 
   0.  -3.   0.    4.    0.    0.     0.    0. 
   1.   0.  -8.    0.    8.    0.     0.    0. 
   0.   5.   0.   -20.   0.    16.    0.    0. 
  -1.   0.   18.   0.   -48.   0.     32.   0. 
   0.  -7.   0.    56.   0.   -112.   0.    64.
//display is ok
disp(nearfloat("succ", expm(A)));
         column 1 to 6
   2.7182818   0.          0.          0.          0.          0.       
   0.          2.7182818   0.          0.0000001   0.         -0.0000002
  -4.6707743   0.          7.3890561   0.          0.          0.       
   0.         -51.879868   0.          54.59815    0.          0.0000002
   986.51887   0.         -3964.7586   0.          2980.9581   0.       
   0.          5923608.3   0.         -14809151.   0.          8885544.9
  -3.505D+12   0.          2.980D+13   0.         -5.258D+13   0.       
   0.         -1.908D+08   0.          8.924D+08   0.         -1.243D+09
         column 7 to 8
   0.          0.       
   0.          8.396D-08
   0.          0.       
   0.         -7.490D-08
  -0.000061    0.       
   0.          0.000001 
   2.629D+13   0.       
   0.          5.417D+08
// now display is ok
format(19);
disp(nearfloat("succ", expm(A)));
         column 1 to 3
   2.7182818284590464   0.                   0.                
   0.                   2.718281801517723    0.                
  -4.6707742704716031   0.                   7.3890560989306477
   0.                  -51.879868171559828   0.                
   986.51887138491577   0.                  -3964.7586192011622
   0.                   5923608.3361952333   0.                
  -3505325614554.6104   0.                   29795267732595.211
   0.                  -190824518.11990353   0.                
         column 4 to 6
   0.                   0.                   0.                
   0.0000001317192459   0.                  -0.0000001887344807
   0.                   0.                   0.                
   54.598149892965438   0.                   0.0000001819498482
   0.                   2980.9580906107221   0.                
  -14809150.54015775    0.                   8885544.9222434219
   0.                  -52579884242037.664   0.                
   892372855.75740469   0.                  -1243259289.722564 
         column 7 to 8
   0.                   0.                
   0.                   0.0000000839564363
   0.                   0.                
   0.                  -0.0000000748965724
  -0.000060966021125    0.                
   0.                   0.0000009705089855
   26289942123999.797   0.                
   0.                   541710954.80334532
A =  matrix(linspace(-1E10,1E20,64), 8, 8);
disp(A);
         column 1 to 3
  -10000000000.         1.269841268968D+19   2.539682538937D+19
   1.587301577460D+18   1.428571427714D+19   2.698412697683D+19
   3.174603164921D+18   1.587301586460D+19   2.857142856429D+19
   4.761904752381D+18   1.746031745206D+19   3.015873015175D+19
   6.349206339841D+18   1.904761903952D+19   3.174603173921D+19
   7.936507927302D+18   2.063492062698D+19   3.333333332667D+19
   9.523809514762D+18   2.222222221444D+19   3.492063491413D+19
   1.111111110222D+19   2.380952380190D+19   3.650793650159D+19
         column 4 to 6
   3.809523808905D+19   5.079365078873D+19   6.349206348841D+19
   3.968253967651D+19   5.238095237619D+19   6.507936507587D+19
   4.126984126397D+19   5.396825396365D+19   6.666666666333D+19
   4.285714285143D+19   5.555555555111D+19   6.825396825079D+19
   4.444444443889D+19   5.714285713857D+19   6.984126983825D+19
   4.603174602635D+19   5.873015872603D+19   7.142857142571D+19
   4.761904761381D+19   6.031746031349D+19   7.301587301317D+19
   4.920634920127D+19   6.190476190095D+19   7.460317460063D+19
         column 7 to 8
   7.619047618810D+19   8.888888888778D+19
   7.777777777556D+19   9.047619047524D+19
   7.936507936302D+19   9.206349206270D+19
   8.095238095048D+19   9.365079365016D+19
   8.253968253794D+19   9.523809523762D+19
   8.412698412540D+19   9.682539682508D+19
   8.571428571286D+19   9.841269841254D+19
   8.730158730032D+19   1.000000000000D+20
format(10);
disp(A);
         column 1 to 6
  -1.000D+10   1.270D+19   2.540D+19   3.810D+19   5.079D+19   6.349D+19
   1.587D+18   1.429D+19   2.698D+19   3.968D+19   5.238D+19   6.508D+19
   3.175D+18   1.587D+19   2.857D+19   4.127D+19   5.397D+19   6.667D+19
   4.762D+18   1.746D+19   3.016D+19   4.286D+19   5.556D+19   6.825D+19
   6.349D+18   1.905D+19   3.175D+19   4.444D+19   5.714D+19   6.984D+19
   7.937D+18   2.063D+19   3.333D+19   4.603D+19   5.873D+19   7.143D+19
   9.524D+18   2.222D+19   3.492D+19   4.762D+19   6.032D+19   7.302D+19
   1.111D+19   2.381D+19   3.651D+19   4.921D+19   6.190D+19   7.460D+19
         column 7 to 8
   7.619D+19   8.889D+19
   7.778D+19   9.048D+19
   7.937D+19   9.206D+19
   8.095D+19   9.365D+19
   8.254D+19   9.524D+19
   8.413D+19   9.683D+19
   8.571D+19   9.841D+19
   8.730D+19   1.000D+20
s = ["-0.034" "- 0.034"  "+1234.5678" "1234 5678"
"1e43"   "-3.5d-12" "-1.2+i"     "i+1.2"
""       "%inf"     "Inf"        "-Inf"
"%i"     "%pi"      "%e"         "%eps"
];
format(10);
disp(strtod(s));
  -0.034       Nan         1234.5678   1234.
   1.000D+43  -3.500D-12  -1.2         Nan  
   Nan         Nan         Nan         Nan  
   Nan         Nan         Nan         Nan  
// display with complex numbers
A =  matrix(linspace(-1E10,1E20,64), 8, 8);
B =  matrix(linspace(1E20,-1E10,64), 8, 8);
B(7, 7) = %nan;
B(2, 1) = %inf;
A(2, 1) = %nan;
A(3, 3) = %nan;
B(4, 4) = 0;
B(4, 3) = -B(4, 3);
A(4, 3) = -A(4, 3);
A(5, 5) = 0;
B(5, 5) = -B(5, 5);
A(6, 6) = 0;
B(6, 6) = 1;
format(19);
disp(A + %i * B);
         column 1
  -10000000000. + 1.000000000000D+20i      
   Nan + Infi                              
   3.174603164921D+18 + 9.682539682508D+19i
   4.761904752381D+18 + 9.523809523762D+19i
   6.349206339841D+18 + 9.365079365016D+19i
   7.936507927302D+18 + 9.206349206270D+19i
   9.523809514762D+18 + 9.047619047524D+19i
   1.111111110222D+19 + 8.888888888778D+19i
         column 2
   1.269841268968D+19 + 8.730158730032D+19i
   1.428571427714D+19 + 8.571428571286D+19i
   1.587301586460D+19 + 8.412698412540D+19i
   1.746031745206D+19 + 8.253968253794D+19i
   1.904761903952D+19 + 8.095238095048D+19i
   2.063492062698D+19 + 7.936507936302D+19i
   2.222222221444D+19 + 7.777777777556D+19i
   2.380952380190D+19 + 7.619047618810D+19i
         column 3
   2.539682538937D+19 + 7.460317460063D+19i
   2.698412697683D+19 + 7.301587301317D+19i
   Nan + 7.142857142571D+19i               
  -3.015873015175D+19 - 6.984126983825D+19i
   3.174603173921D+19 + 6.825396825079D+19i
   3.333333332667D+19 + 6.666666666333D+19i
   3.492063491413D+19 + 6.507936507587D+19i
   3.650793650159D+19 + 6.349206348841D+19i
         column 4
   3.809523808905D+19 + 6.190476190095D+19i
   3.968253967651D+19 + 6.031746031349D+19i
   4.126984126397D+19 + 5.873015872603D+19i
   4.285714285143D+19                      
   4.444444443889D+19 + 5.555555555111D+19i
   4.603174602635D+19 + 5.396825396365D+19i
   4.761904761381D+19 + 5.238095237619D+19i
   4.920634920127D+19 + 5.079365078873D+19i
         column 5
   5.079365078873D+19 + 4.920634920127D+19i
   5.238095237619D+19 + 4.761904761381D+19i
   5.396825396365D+19 + 4.603174602635D+19i
   5.555555555111D+19 + 4.444444443889D+19i
  -4.285714285143D+19i                     
   5.873015872603D+19 + 4.126984126397D+19i
   6.031746031349D+19 + 3.968253967651D+19i
   6.190476190095D+19 + 3.809523808905D+19i
         column 6
   6.349206348841D+19 + 3.650793650159D+19i
   6.507936507587D+19 + 3.492063491413D+19i
   6.666666666333D+19 + 3.333333332667D+19i
   6.825396825079D+19 + 3.174603173921D+19i
   6.984126983825D+19 + 3.015873015175D+19i
   i                                       
   7.301587301317D+19 + 2.698412697683D+19i
   7.460317460063D+19 + 2.539682538937D+19i
         column 7
   7.619047618810D+19 + 2.380952380190D+19i
   7.777777777556D+19 + 2.222222221444D+19i
   7.936507936302D+19 + 2.063492062698D+19i
   8.095238095048D+19 + 1.904761903952D+19i
   8.253968253794D+19 + 1.746031745206D+19i
   8.412698412540D+19 + 1.587301586460D+19i
   Nan + Nani                              
   8.730158730032D+19 + 1.269841268968D+19i
         column 8
   8.888888888778D+19 + 1.111111110222D+19i
   9.047619047524D+19 + 9.523809514762D+18i
   9.206349206270D+19 + 7.936507927302D+18i
   9.365079365016D+19 + 6.349206339841D+18i
   9.523809523762D+19 + 4.761904752381D+18i
   9.682539682508D+19 + 3.174603164921D+18i
   9.841269841254D+19 + 1.587301577460D+18i
   1.000000000000D+20 - 10000000000.i      
format(10);
disp(A + %i * B);
         column 1 to 2
  -1.000D+10 + 1.000D+20i   1.270D+19 + 8.730D+19i
   Nan + Infi               1.429D+19 + 8.571D+19i
   3.175D+18 + 9.683D+19i   1.587D+19 + 8.413D+19i
   4.762D+18 + 9.524D+19i   1.746D+19 + 8.254D+19i
   6.349D+18 + 9.365D+19i   1.905D+19 + 8.095D+19i
   7.937D+18 + 9.206D+19i   2.063D+19 + 7.937D+19i
   9.524D+18 + 9.048D+19i   2.222D+19 + 7.778D+19i
   1.111D+19 + 8.889D+19i   2.381D+19 + 7.619D+19i
         column 3 to 4
   2.540D+19 + 7.460D+19i   3.810D+19 + 6.190D+19i
   2.698D+19 + 7.302D+19i   3.968D+19 + 6.032D+19i
   Nan + 7.143D+19i         4.127D+19 + 5.873D+19i
  -3.016D+19 - 6.984D+19i   4.286D+19             
   3.175D+19 + 6.825D+19i   4.444D+19 + 5.556D+19i
   3.333D+19 + 6.667D+19i   4.603D+19 + 5.397D+19i
   3.492D+19 + 6.508D+19i   4.762D+19 + 5.238D+19i
   3.651D+19 + 6.349D+19i   4.921D+19 + 5.079D+19i
         column 5 to 6
   5.079D+19 + 4.921D+19i   6.349D+19 + 3.651D+19i
   5.238D+19 + 4.762D+19i   6.508D+19 + 3.492D+19i
   5.397D+19 + 4.603D+19i   6.667D+19 + 3.333D+19i
   5.556D+19 + 4.444D+19i   6.825D+19 + 3.175D+19i
  -4.286D+19i               6.984D+19 + 3.016D+19i
   5.873D+19 + 4.127D+19i   i                     
   6.032D+19 + 3.968D+19i   7.302D+19 + 2.698D+19i
   6.190D+19 + 3.810D+19i   7.460D+19 + 2.540D+19i
         column 7 to 8
   7.619D+19 + 2.381D+19i   8.889D+19 + 1.111D+19i
   7.778D+19 + 2.222D+19i   9.048D+19 + 9.524D+18i
   7.937D+19 + 2.063D+19i   9.206D+19 + 7.937D+18i
   8.095D+19 + 1.905D+19i   9.365D+19 + 6.349D+18i
   8.254D+19 + 1.746D+19i   9.524D+19 + 4.762D+18i
   8.413D+19 + 1.587D+19i   9.683D+19 + 3.175D+18i
   Nan + Nani               9.841D+19 + 1.587D+18i
   8.730D+19 + 1.270D+19i   1.000D+20 - 1.000D+10i
format("e");
disp(A + %i * B);
         column 1 to 2
  -1.000D+10 + 1.000D+20i   1.270D+19 + 8.730D+19i
   Nan + Infi               1.429D+19 + 8.571D+19i
   3.175D+18 + 9.683D+19i   1.587D+19 + 8.413D+19i
   4.762D+18 + 9.524D+19i   1.746D+19 + 8.254D+19i
   6.349D+18 + 9.365D+19i   1.905D+19 + 8.095D+19i
   7.937D+18 + 9.206D+19i   2.063D+19 + 7.937D+19i
   9.524D+18 + 9.048D+19i   2.222D+19 + 7.778D+19i
   1.111D+19 + 8.889D+19i   2.381D+19 + 7.619D+19i
         column 3 to 4
   2.540D+19 + 7.460D+19i   3.810D+19 + 6.190D+19i
   2.698D+19 + 7.302D+19i   3.968D+19 + 6.032D+19i
   Nan + 7.143D+19i         4.127D+19 + 5.873D+19i
  -3.016D+19 - 6.984D+19i   4.286D+19             
   3.175D+19 + 6.825D+19i   4.444D+19 + 5.556D+19i
   3.333D+19 + 6.667D+19i   4.603D+19 + 5.397D+19i
   3.492D+19 + 6.508D+19i   4.762D+19 + 5.238D+19i
   3.651D+19 + 6.349D+19i   4.921D+19 + 5.079D+19i
         column 5 to 6
   5.079D+19 + 4.921D+19i   6.349D+19 + 3.651D+19i
   5.238D+19 + 4.762D+19i   6.508D+19 + 3.492D+19i
   5.397D+19 + 4.603D+19i   6.667D+19 + 3.333D+19i
   5.556D+19 + 4.444D+19i   6.825D+19 + 3.175D+19i
  -4.286D+19i               6.984D+19 + 3.016D+19i
   5.873D+19 + 4.127D+19i   1.000D+00i            
   6.032D+19 + 3.968D+19i   7.302D+19 + 2.698D+19i
   6.190D+19 + 3.810D+19i   7.460D+19 + 2.540D+19i
         column 7 to 8
   7.619D+19 + 2.381D+19i   8.889D+19 + 1.111D+19i
   7.778D+19 + 2.222D+19i   9.048D+19 + 9.524D+18i
   7.937D+19 + 2.063D+19i   9.206D+19 + 7.937D+18i
   8.095D+19 + 1.905D+19i   9.365D+19 + 6.349D+18i
   8.254D+19 + 1.746D+19i   9.524D+19 + 4.762D+18i
   8.413D+19 + 1.587D+19i   9.683D+19 + 3.175D+18i
   Nan + Nani               9.841D+19 + 1.587D+18i
   8.730D+19 + 1.270D+19i   1.000D+20 - 1.000D+10i
